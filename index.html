<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å·´ä¼¦2026 Â· ç­–é©¬â€œé‡‘â€ç¨‹</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700;900&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        /* --- å…¨å±€é‡ç½® --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        /* 1. BodyèƒŒæ™¯ï¼šæ¢å¤ä¸ºæ‚¨å–œæ¬¢çš„â€œæš—çº¢ç£¨ç ‚â€è´¨æ„Ÿ */
        body {
            font-family: "Noto Serif SC", "PingFang SC", serif;
            background-color: #4a0404;
            /* ä»…ä¿ç•™æš—çº¹ï¼Œå»æ‰å¼ºçƒˆçš„çº¿æ€§æ¸å˜ï¼Œè®©å®ƒæ²‰ä¸‹å»åšèƒŒæ™¯ */
            background-image: 
                radial-gradient(#6d0b0b 15%, transparent 16%),
                radial-gradient(#6d0b0b 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            color: #333;
        }

        /* 2. æ‰‹æœºå®¹å™¨ï¼šæ¢å¤ç‹¬ç«‹çš„äº®çº¢æ¸å˜ + é˜´å½± */
        #app-container {
            width: 100%;
            max-width: 414px;
            height: 100vh;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            position: relative;
            /* è¿™é‡Œæ¢å¤äº†æ ¸å¿ƒçš„â€œæ‰‹æœºå±â€å…‰æ„Ÿ */
            background: linear-gradient(180deg, #8B0000 0%, #3e0202 100%);
            /* æ¢å¤ç«‹ä½“æŠ•å½± */
            box-shadow: 0 0 30px rgba(0,0,0,0.7);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- é¡¶éƒ¨è£…é¥° --- */
        .decoration-top {
            position: absolute; top: -20px; left: 0; width: 100%; height: 80px;
            background: url('data:image/svg+xml;utf8,<svg viewBox="0 0 1440 320" xmlns="http://www.w3.org/2000/svg"><path fill="%23FFD700" fill-opacity="0.1" d="M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,224C672,245,768,267,864,250.7C960,235,1056,181,1152,165.3C1248,149,1344,171,1392,181.3L1440,192L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z"></path></svg>');
            background-size: cover; z-index: 1;
        }
        .logo-container { margin-top: 35px; text-align: center; z-index: 10; padding: 0 20px; flex-shrink: 0; }
        .logo-img { width: 140px; height: auto; display: block; margin: 0 auto; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }

        /* --- æ ¸å¿ƒç»„ä»¶ --- */
        .btn {
            width: 100%;
            background: linear-gradient(135deg, #2ecbe9 0%, #1DB2D4 50%, #158ca7 100%);
            border: 2px solid rgba(255,255,255,0.2);
            color: #fff;
            font-family: "Noto Serif SC", serif;
            padding: 16px 0;
            font-size: 19px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(29, 178, 212, 0.4), 0 4px 0 #106e82;
            transition: all 0.2s ease;
            letter-spacing: 2px;
        }
        .btn:active { transform: translateY(4px); box-shadow: 0 4px 10px rgba(29, 178, 212, 0.2); }
        .btn:disabled { background: #666; box-shadow: none; cursor: not-allowed; opacity: 0.8; color: #aaa; }
        
        .btn-task { padding: 8px 15px; font-size: 13px; width: auto; background: linear-gradient(135deg, #FFD700, #FFA500); border: none; color: #8B0000; box-shadow: 0 3px 10px rgba(0,0,0,0.3); border-radius: 20px; cursor: pointer;}
        .btn-task.done { background: rgba(255,255,255,0.2); color: #aaa; box-shadow: none; pointer-events: none; }

        .hidden { display: none !important; }
        .fade-out { opacity: 0; pointer-events: none; transition: opacity 0.5s ease; }
        .fade-in { opacity: 1 !important; display: flex !important; }

        /* --- é¦–é¡µ --- */
        #page-landing { flex: 1; display: flex; flex-direction: column; width: 100%; z-index: 10; }
        .landing-content-wrapper { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding-bottom: 20px; }
        .visual-wrapper { position: relative; width: 180px; height: 180px; margin-bottom: 20px; display: flex; justify-content: center; align-items: center; }
        .circle-bg { position: absolute; width: 100%; height: 100%; border-radius: 50%; border: 2px solid rgba(255, 215, 0, 0.3); box-shadow: 0 0 20px rgba(255, 215, 0, 0.1); animation: rotate 20s linear infinite; }
        .circle-bg::before { content: ''; position: absolute; top: -4px; left: 50%; width: 8px; height: 8px; background: #FFD700; border-radius: 50%; box-shadow: 0 0 8px #FFD700; }
        .horse-image-container { width: 140px; height: 140px; border-radius: 50%; overflow: hidden; border: 3px solid #FFD700; box-shadow: 0 10px 20px rgba(0,0,0,0.5); background: #000; }
        .horse-img { width: 100%; height: 100%; object-fit: cover; filter: contrast(1.2) sepia(0.5) hue-rotate(5deg); }
        .title-group { text-align: center; color: #fff; }
        .year-text { font-family: 'Playfair Display', serif; font-size: 46px; color: transparent; background: linear-gradient(to bottom, #FFD700, #FDB931, #C06300); -webkit-background-clip: text; font-weight: bold; line-height: 1; margin-bottom: 5px; text-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .main-title { font-size: 26px; font-weight: 700; letter-spacing: 4px; margin-bottom: 15px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .sub-title { display: inline-block; border-top: 1px solid rgba(255,215,0,0.5); border-bottom: 1px solid rgba(255,215,0,0.5); padding: 6px 15px; color: #FFD700; font-size: 13px; letter-spacing: 2px; opacity: 0.9; }
        .action-area { width: 100%; text-align: center; z-index: 10; padding-bottom: 100px; flex-shrink: 0; }
        .btn-wrapper { position: relative; display: inline-block; width: 80%; }
        .hint-text { margin-top: 15px; color: #FFD700; font-size: 13px; letter-spacing: 1px; font-weight: bold; background: rgba(0,0,0,0.3); padding: 5px 15px; border-radius: 20px; display: inline-block; cursor: pointer; }

        /* --- ç»“æœé¡µ --- */
        #page-result { display: none; opacity: 0; width: 100%; flex: 1; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 20px; z-index: 15; transition: opacity 0.5s ease; }
        .fortune-card-container { width: 85%; background-color: #fffbe0; background-image: url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23d9d0b6' fill-opacity='0.4' fill-rule='evenodd'%3E%3Cpath d='M5 0h1L0 6V5zM6 5v1H5z'/%3E%3C/g%3E%3C/svg%3E"); border-radius: 12px; padding: 30px 25px; box-shadow: 0 15px 40px rgba(0,0,0,0.6); border: 1px solid #e0d0a0; position: relative; text-align: center; margin-bottom: 30px; animation: cardSlideUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1); }
        .fortune-card-container::after { content: ''; position: absolute; top: 6px; left: 6px; right: 6px; bottom: 6px; border: 2px solid #D4AF37; border-radius: 8px; pointer-events: none; }
        .fortune-badge { display: inline-block; border: 2px solid #8B0000; color: #8B0000; font-size: 28px; font-weight: 900; padding: 5px 15px; border-radius: 4px; margin-bottom: 20px; letter-spacing: 5px; }
        .fortune-title { font-size: 24px; color: #222; font-weight: bold; margin-bottom: 25px; }
        .fortune-text { font-size: 15px; line-height: 1.8; color: #444; text-align: justify; margin-bottom: 30px; padding: 0 10px; font-weight: 500; }
        .divider { height: 1px; background: linear-gradient(to right, transparent, #ccc, transparent); margin-bottom: 15px; }
        .fortune-footer { font-size: 11px; color: #888; letter-spacing: 1px; text-transform: uppercase; }
        .gift-trigger { width: 85%; background: linear-gradient(135deg, #FF512F 0%, #DD2476 100%); border-radius: 10px; padding: 15px 20px; display: flex; align-items: center; justify-content: space-between; color: #fff; box-shadow: 0 8px 20px rgba(221, 36, 118, 0.4); cursor: pointer; animation: pulse 2s infinite; border: 1px solid rgba(255,255,255,0.3); margin-bottom: 30px; }
        .gift-icon { font-size: 28px; margin-right: 15px; }
        .gift-text { text-align: left; flex: 1; }
        .gift-title { font-size: 16px; font-weight: bold; margin-bottom: 2px; }
        .gift-desc { font-size: 12px; opacity: 0.9; }
        .gift-arrow { font-size: 18px; opacity: 0.8; }

        /* --- ä¿ƒé”€é¡µ (ä¸¥æ ¼æŒ‰ç…§æ‚¨çš„å›¾ç‰‡æ ·å¼æ¢å¤) --- */
        #page-offer { display: none; opacity: 0; width: 100%; flex: 1; flex-direction: column; align-items: center; justify-content: flex-start; z-index: 15; transition: opacity 0.5s ease; padding: 0 20px 60px 20px; overflow-y: auto; -webkit-overflow-scrolling: touch; }
        .offer-header { text-align: center; margin-bottom: 20px; color: #fff; animation: cardSlideUp 0.6s ease; flex-shrink: 0; }
        .offer-header h2 { font-size: 24px; margin-bottom: 5px; color: #FFD700; text-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        .offer-header p { font-size: 13px; opacity: 0.8; letter-spacing: 1px; }
        
        .price-card {
            width: 100%;
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 16px;
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            backdrop-filter: blur(10px);
            animation: cardSlideUp 0.8s ease;
            flex-shrink: 0;
        }
        .original-price { color: #aaa; text-decoration: line-through; font-size: 14px; margin-bottom: 5px; }
        .final-price-row { display: flex; justify-content: center; align-items: baseline; margin-bottom: 10px; }
        .currency { font-size: 24px; color: #FFD700; margin-right: 5px; }
        .price-num { font-size: 48px; font-weight: bold; color: #FFD700; font-family: 'Playfair Display', serif; line-height: 1; }
        .tag { background: linear-gradient(90deg, #FFD700, #FFA500); color: #8B0000; font-size: 12px; padding: 2px 8px; border-radius: 4px; font-weight: bold; margin-left: 10px; transform: translateY(-10px); }
        .daily-price { font-size: 14px; color: #fff; background: rgba(255,255,255,0.1); display: inline-block; padding: 4px 15px; border-radius: 20px; }
        
        .countdown-container { text-align: center; margin-bottom: 15px; margin-top: 5px; animation: cardSlideUp 1s ease; flex-shrink: 0; }
        .countdown-label { font-size: 12px; color: rgba(255,255,255,0.7); margin-bottom: 5px; }
        .timer-display { font-size: 20px; color: #FFD700; font-family: monospace; font-weight: bold; letter-spacing: 2px; }
        
        .section-title { color: #FFD700; font-size: 15px; margin: 30px 0 15px 0; opacity: 0.9; text-align: center; letter-spacing: 3px; font-weight: bold; display: flex; align-items: center; justify-content: center; animation: cardSlideUp 1.2s ease; flex-shrink: 0; }
        .section-title::before, .section-title::after { content: ''; display: block; width: 30px; height: 1px; background: linear-gradient(90deg, transparent, #FFD700); margin: 0 10px; }
        .section-title::after { background: linear-gradient(90deg, #FFD700, transparent); }
        
        .benefit-img { 
            width: 100%; height: auto; 
            border-radius: 12px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.4); 
            margin-bottom: 10px; 
            animation: cardSlideUp 1.2s ease; 
            border: 1px solid rgba(255,215,0,0.2); 
            flex-shrink: 0; 
        }
        
        .rules-container { width: 100%; background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; margin-top: 20px; margin-bottom: 20px; border: 1px dashed rgba(255,255,255,0.15); animation: cardSlideUp 1.4s ease; flex-shrink: 0; }
        .rules-title { font-size: 12px; color: #ccc; margin-bottom: 8px; font-weight: bold; }
        .rules-list { list-style: none; text-align: left; padding: 0; margin: 0; }
        .rules-list li { font-size: 11px; color: rgba(255,255,255,0.5); line-height: 1.8; margin-bottom: 4px; text-align: justify; position: relative; padding-left: 12px; }
        .rules-list li::before { content: 'â€¢'; position: absolute; left: 0; color: #666; }
        .footer-note { font-size: 10px; color: rgba(255,255,255,0.3); text-align: center; margin-top: 0; margin-bottom: 20px; flex-shrink: 0; }

        /* --- ä»»åŠ¡ä¸­å¿ƒé¡µ --- */
        #page-tasks { display: none; opacity: 0; width: 100%; flex: 1; flex-direction: column; align-items: center; padding: 0 20px; z-index: 15; transition: opacity 0.5s ease; overflow-y: auto; }
        .task-list { width: 100%; margin-top: 20px; }
        .task-item { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,215,0,0.2); border-radius: 12px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; justify-content: space-between; animation: cardSlideUp 0.5s ease; }
        .task-info { display: flex; align-items: center; }
        .task-icon { font-size: 24px; margin-right: 15px; width: 40px; text-align: center; background: rgba(255,215,0,0.1); border-radius: 50%; height: 40px; line-height: 40px; }
        .task-desc h4 { font-size: 15px; color: #FFD700; margin-bottom: 4px; }
        .task-desc p { font-size: 11px; color: rgba(255,255,255,0.6); }
        .back-home { margin-top: 30px; font-size: 14px; color: #aaa; text-decoration: underline; cursor: pointer; margin-bottom: 40px; }

        /* --- æ‚¬æµ®æŒ‰é’®ç»„ (ç»å¯¹å®šä½åœ¨å®¹å™¨å†…ï¼Œç¡®ä¿è·Ÿéšæ‰‹æœºä½ç½®) --- */
        .float-btn-group {
            position: absolute; 
            bottom: 30px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 999;
        }
        
        .float-btn {
            width: 50px; height: 50px; background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 50%; box-shadow: 0 5px 15px rgba(0,0,0,0.6), 0 0 0 2px rgba(255,255,255,0.8);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; animation: pulse-btn 3s infinite;
        }
        .float-btn.secondary { width: 40px; height: 40px; background: #fff; border: none; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        .float-btn span { font-size: 20px; }
        .float-btn.secondary span { font-size: 16px; }
        .float-btn p { font-size: 9px; color: #8B0000; font-weight: bold; margin-top: -2px; }
        
        @keyframes pulse-btn {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* --- å¼¹çª— --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .coupon-modal-content { width: 85%; max-width: 350px; background: #fff; border-radius: 15px; padding: 25px; text-align: center; position: relative; }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 24px; color: #999; cursor: pointer; }
        .coupon-list-container { max-height: 300px; overflow-y: auto; margin-top: 15px; }
        .coupon-item { background: #fffbe0; border: 1px solid #FFD700; border-radius: 8px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .c-left h4 { font-size: 16px; color: #d93025; margin-bottom: 5px; }
        .c-left p { font-size: 12px; color: #666; }
        .c-btn { background: #d93025; color: #fff; border: none; padding: 5px 12px; border-radius: 20px; font-size: 12px; }
        .share-text { margin-top: 150px; color: #fff; font-size: 18px; line-height: 1.5; text-align: center; }

        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
        @keyframes cardSlideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

    <div id="app-container">
        
        <div class="float-btn-group">
            <div class="float-btn secondary" onclick="goToTasks()"><span>âš¡</span></div>
            <div class="float-btn" onclick="showCouponModal()"><span>ğŸŸï¸</span><p>å¡åˆ¸</p></div>
        </div>

        <div class="decoration-top"></div>
        <div class="logo-container">
            <img src="https://admin.barrons.com.cn/uploads/cover_image/2026/01/19/1768790601_a5adc63e4ca8b95da3db.png" alt="Barron's Logo" class="logo-img">
        </div>

        <div id="page-landing">
            <div class="landing-content-wrapper">
                <div class="visual-wrapper floating">
                    <div class="circle-bg"></div>
                    <div class="horse-image-container">
                        <img src="https://images.unsplash.com/photo-1553284965-83fd3e82fa5a?q=80&w=400&auto=format&fit=crop" alt="Golden Horse" class="horse-img">
                    </div>
                </div>
                <div class="title-group">
                    <div class="year-text">2026</div>
                    <h1 class="main-title">ç­–é©¬â€œé‡‘â€ç¨‹</h1>
                    <div class="sub-title">å…¨çƒæŠ•èµ„é¢†è·‘è®¡åˆ’</div>
                </div>
            </div>
            <div class="action-area">
                <div class="btn-wrapper">
                    <button class="btn" id="drawBtn" onclick="checkAndDraw()">æ±‚å–é©¬å¹´ç¾è‚¡çµç­¾</button>
                </div>
                <div class="hint-text" id="drawHint" onclick="goToTasks()">ä»Šæ—¥å‰©ä½™æœºä¼šï¼š100/100</div>
            </div>
        </div>

        <div id="page-result">
            <div class="fortune-card-container">
                <div class="fortune-badge" id="res-fortune-badge">ä¸Šä¸Šç­¾</div>
                <h2 class="fortune-title" id="res-fortune-title">AI ç­–é©¬ç‹‚å¥”</h2>
                <div class="fortune-text" id="res-fortune-text">
                    é©¬å¹´ä¼Šå§‹ï¼Œç§‘æŠ€æˆé•¿è‚¡åŠ¨åŠ›å¼ºåŠ²ã€‚ä½ çš„æŠ•èµ„ç»„åˆå°†å¦‚è‰¯é©¹é‡ä¼¯ä¹ï¼Œåœ¨ç®—åŠ›ä¸åº”ç”¨çˆ†å‘ä¸­ï¼Œè·å¾—è¶…ä¹é¢„æœŸçš„ Alpha å›æŠ¥ã€‚
                </div>
                <div class="divider"></div>
                <div class="fortune-footer">Barron's å·´ä¼¦</div>
            </div>

            <div class="gift-trigger" onclick="goToOffer()">
                <div class="gift-icon">ğŸ§§</div>
                <div class="gift-text">
                    <div class="gift-title" id="res-gift-title">æ­å–œï¼å‘ç°ä¸€ä¸ªâ€œä»·å€¼562å…ƒçš„é©¬å¹´ä¸“å±ä¼˜æƒ åˆ¸â€</div>
                    <div class="gift-desc">ç‚¹å‡»æ‹†å¼€ï¼Œè§£é”å·´ä¼¦é©¬å¹´ä¸“å±æƒç›Š</div>
                </div>
                <div class="gift-arrow">á³</div>
            </div>

            <div style="text-align: center; margin-top: -10px; margin-bottom: 20px;">
                <p style="color: rgba(255,255,255,0.6); font-size: 12px; margin-bottom: 10px;">è§‰å¾—å‡†ï¼Ÿåˆ†äº«ç»™å¥½å‹é›†å¥½è¿</p>
                <button onclick="goToTasks()" style="background:transparent; border:1px solid rgba(255,215,0,0.5); color:#FFD700; padding: 5px 15px; border-radius: 20px; font-size: 13px;">âš¡ åšä»»åŠ¡èµšæ¬¡æ•°</button>
            </div>
        </div>

        <div id="page-offer">
            <div class="offer-header">
                <h2>é©¬å¹´é™å®šç¤¼é‡</h2>
                <p>åŠ©ä½ åœ¨2026ç¾è‚¡å¸‚åœºä¸€é©¬å½“å…ˆ</p>
            </div>
            
            <div class="price-card">
                <div class="original-price">åŸä»· Â¥ 1080 / å¹´</div>
                <div class="final-price-row">
                    <span class="currency">Â¥</span>
                    <span class="price-num" id="offer-price-num">518</span>
                    <span class="tag" id="offer-tag">å·²ä¼˜æƒ 562å…ƒ</span>
                </div>
                <div class="daily-price" id="offer-daily-price">å·²æ¯”å®˜ç½‘æ¸ é“ä»·è¿˜ä¼˜æƒ 180å…ƒ</div>
            </div>
            
            <div class="countdown-container">
                <div class="countdown-label">ä¼˜æƒ å¤±æ•ˆå€’è®¡æ—¶</div>
                <div class="timer-display" id="timer">04:59:59</div>
            </div>
            <div class="btn-wrapper" style="width: 100%; margin-bottom: 10px; animation: cardSlideUp 1s ease; flex-shrink: 0;">
                <button class="btn" onclick="alert('å³å°†è·³è½¬æ”¯ä»˜ç½‘å…³...')">å¼€å¯é©¬å¹´è´¢è¿</button>
            </div>
            
            <h3 class="section-title">ä¼šå‘˜æ ¸å¿ƒæƒç›Š</h3>
            <img src="https://admin.barrons.com.cn/uploads/cover_image/2026/01/19/1768794382_315d133577c4362dac71.jpg" alt="ä¼šå‘˜æƒç›Šä»‹ç»" class="benefit-img">
            
            <div class="rules-container">
                <div class="rules-title">æ´»åŠ¨è§„åˆ™è¯´æ˜ï¼š</div>
                <ul class="rules-list">
                    <li>æ´»åŠ¨æ—¶é—´ï¼šå³æ—¥èµ·è‡³2026å¹´2æœˆ12æ—¥ï¼ˆæ­£æœˆåäº”ï¼‰ã€‚</li>
                    <li>ä¼˜æƒ å¯¹è±¡ï¼šæœ¬ä¼˜æƒ ä»…é™å·´ä¼¦ä¸­æ–‡ç½‘æ³¨å†Œç”¨æˆ·å‚ä¸ï¼Œæ–°è€ç”¨æˆ·çš†å¯äº«å—ã€‚</li>
                    <li>æƒç›Šå‘æ”¾ï¼šè®¢é˜…æˆåŠŸåï¼Œä¼šå‘˜æƒç›Šå°†å³æ—¶å‘æ”¾ã€‚</li>
                    <li>é€€æ¬¾è¯´æ˜ï¼šè™šæ‹Ÿå•†å“ï¼Œä¸€ç»å”®å‡ºæ¦‚ä¸é€€æ¬¾ã€‚</li>
                </ul>
            </div>
            <div class="footer-note">*æ´»åŠ¨æœ€ç»ˆè§£é‡Šæƒå½’å·´ä¼¦ä¸­æ–‡ç½‘æ‰€æœ‰</div>
        </div>

        <div id="page-tasks">
            <div class="offer-header">
                <h2>èµšå–çµç­¾æ¬¡æ•°</h2>
                <p>å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼Œè·å–æ›´å¤šå¼€å¯å¥½è¿çš„æœºä¼š</p>
            </div>
            <div class="task-list">
                <div class="task-item">
                    <div class="task-info"><div class="task-icon">ğŸ“…</div><div class="task-desc"><h4>æ¯æ—¥ç­¾åˆ°</h4><p>æ¯å¤©ä¸€æ¬¡ï¼Œä¿æŒå…³æ³¨</p></div></div>
                    <div><span style="color:#FFD700; font-size:12px; margin-right:5px;">+1æ¬¡</span><button class="btn btn-task" id="btn-checkin" onclick="doTask('checkin')">ç­¾åˆ°</button></div>
                </div>
                <div class="task-item">
                    <div class="task-info"><div class="task-icon">ğŸ’¬</div><div class="task-desc"><h4>åˆ†äº«ç»™å¾®ä¿¡å¥½å‹</h4><p>é‚€è¯·å¥½å‹æµ‹è¿åŠ¿</p></div></div>
                    <div><span style="color:#FFD700; font-size:12px; margin-right:5px;">+1æ¬¡</span><button class="btn btn-task" onclick="doTask('share_friend')">å»åˆ†äº«</button></div>
                </div>
                <div class="task-item">
                    <div class="task-info"><div class="task-icon">â­•</div><div class="task-desc"><h4>åˆ†äº«åˆ°æœ‹å‹åœˆ</h4><p>è®©æ›´å¤šäººçœ‹åˆ°ä½ çš„å¥½è¿</p></div></div>
                    <div><span style="color:#FFD700; font-size:12px; margin-right:5px;">+2æ¬¡</span><button class="btn btn-task" onclick="doTask('share_moments')">å»åˆ†äº«</button></div>
                </div>
                <div class="task-item">
                    <div class="task-info"><div class="task-icon">ğŸ“–</div><div class="task-desc"><h4>é˜…è¯»å·´ä¼¦æ·±åº¦æ–‡ç« </h4><p>æ´å¯Ÿ2026å¸‚åœºå…ˆæœº</p></div></div>
                    <div><span style="color:#FFD700; font-size:12px; margin-right:5px;">+1æ¬¡</span><button class="btn btn-task" id="btn-read" onclick="doTask('read_article')">å»é˜…è¯»</button></div>
                </div>
            </div>
            <div class="back-home" onclick="backToHome()">è¿”å›é¦–é¡µ</div>
        </div>

        <div id="couponModal" class="modal-overlay" onclick="closeModal(this)">
            <div class="coupon-modal-content" onclick="event.stopPropagation()">
                <div class="close-btn" onclick="closeModal(document.getElementById('couponModal'))">Ã—</div>
                <h3>æˆ‘çš„ç¤¼é‡</h3>
                <div class="coupon-list-container" id="couponList"></div>
            </div>
        </div>
        <div id="shareModal" class="modal-overlay" onclick="closeModal(this)">
            <div style="position: absolute; top: 10px; right: 20px; font-size: 40px; color: #fff;">â†—</div>
            <div class="share-text">
                <p>ç‚¹å‡»å³ä¸Šè§’ [...]</p><p>åˆ†äº«ç»™å¥½å‹æˆ–æœ‹å‹åœˆ</p><p style="margin-top: 20px; font-size: 14px; color: #FFD700;">æˆåŠŸåˆ†äº«åï¼Œç«‹å³è·å¾—å¥–åŠ±ï¼</p>
                <button onclick="simulateShareSuccess()" style="margin-top: 30px; background: #fff; color: #333; border: none; padding: 10px 30px; border-radius: 20px;">(æ¨¡æ‹Ÿ) åˆ†äº«æˆåŠŸ</button>
            </div>
        </div>
        
    </div>

    <script>
        // --- 1. é…ç½®æ•°æ® (Random Logic) ---
        const BASE_DAILY_LIMIT = 100;
        const ORIGINAL_PRICE = 1080;

        const fortuneConfig = [
            { badge: "ä¸Šä¸Šç­¾", title: "AI ç­–é©¬ç‹‚å¥”", text: "é©¬å¹´ä¼Šå§‹ï¼Œç§‘æŠ€æˆé•¿è‚¡åŠ¨åŠ›å¼ºåŠ²ã€‚ä½ çš„æŠ•èµ„ç»„åˆå°†å¦‚è‰¯é©¹é‡ä¼¯ä¹ï¼Œåœ¨ç®—åŠ›ä¸åº”ç”¨çˆ†å‘ä¸­ï¼Œè·å¾—è¶…ä¹é¢„æœŸçš„ Alpha å›æŠ¥ã€‚" },
            { badge: "ä¸­å‰ç­¾", title: "é™æ¯ æŸ³æš—èŠ±æ˜", text: "ç¾è”å‚¨æ”¿ç­–è½¬å‘å¸¦æ¥æµåŠ¨æ€§çº¢åˆ©ã€‚ä¸­å°ç›˜è‚¡è¿æ¥æ˜¥å¤©ï¼Œè€å¿ƒæŒæœ‰çš„ä½ ç»ˆå°†ç­‰åˆ°ä»·å€¼å›å½’çš„é«˜å…‰æ—¶åˆ»ã€‚" },
            { badge: "ä¸Šå‰ç­¾", title: "é¿é™© ç¨³å¦‚è€é©¬", text: "å¸‚åœºæ³¢åŠ¨åŠ å‰§ï¼Œä½†é˜²å¾¡æ€§ç­–ç•¥å°†å¤§æ”¾å¼‚å½©ã€‚é«˜è‚¡æ¯ä¸å…¬ç”¨äº‹ä¸šæ¿å—å°†æˆä¸ºä½ èµ„äº§æŠ¤åŸæ²³çš„åšå®åŸºçŸ³ã€‚" },
            { badge: "å¤§å‰ç­¾", title: "å‡ºæµ· ä¸‡é©¬å¥”è…¾", text: "å…¨çƒåŒ–é…ç½®æ­£å½“æ—¶ã€‚æ”¾çœ¼æµ·å¤–ï¼Œæ–°å…´å¸‚åœºçš„æœºé‡å¦‚ä¸‡é©¬å¥”è…¾è€Œæ¥ï¼ŒåŠ©ä½ å®ç°èµ„äº§çš„è·¨è¶Šå¼å¢å€¼ã€‚" },
            { badge: "ä¸Šä¸Šç­¾", title: "åˆ›æ–° ä¸€é©¬å½“å…ˆ", text: "é¢ è¦†æ€§åˆ›æ–°æ­£åœ¨å‘ç”Ÿã€‚å…³æ³¨ç”Ÿç‰©åŒ»è¯ä¸æ–°èƒ½æºå‰æ²¿ï¼Œæ•¢ä¸ºäººå…ˆçš„å¸ƒå±€å°†è®©ä½ åœ¨é©¬å¹´èµ¢å¾—å…ˆæœºã€‚" }
        ];

        const couponConfig = [
            { finalPrice: 518, prob: 0.1 },
            { finalPrice: 618, prob: 0.3 },
            { finalPrice: 688, prob: 0.4 },
            { finalPrice: 888, prob: 0.2 }
        ];

        let currentDrawResult = null;
        let currentTaskType = '';

        document.addEventListener('DOMContentLoaded', () => {
            updateDrawUI();
        });

        // --- 2. æ ¸å¿ƒé€»è¾‘ ---

        function getPlayData() {
            const today = new Date().toDateString();
            const raw = localStorage.getItem('barrons_play_data_v5');
            let data = raw ? JSON.parse(raw) : null;
            if (!data || data.date !== today) {
                data = { date: today, used_count: 0, earned_count: 0, tasks: { checkin: false, read: false } };
                localStorage.setItem('barrons_play_data_v5', JSON.stringify(data));
            }
            return data;
        }

        function savePlayData(data) {
            localStorage.setItem('barrons_play_data_v5', JSON.stringify(data));
            updateDrawUI();
        }

        function getRemainingChances() {
            const data = getPlayData();
            return (BASE_DAILY_LIMIT + data.earned_count) - data.used_count;
        }

        function updateDrawUI() {
            const remaining = getRemainingChances();
            const btn = document.getElementById('drawBtn');
            const hint = document.getElementById('drawHint');
            
            if (remaining <= 0) {
                btn.innerText = "åšä»»åŠ¡å¾—æ¬¡æ•°";
                btn.onclick = goToTasks;
                btn.style.background = "linear-gradient(135deg, #FFD700, #FFA500)";
                btn.style.color = "#8B0000";
                hint.innerText = "ä»Šæ—¥æ¬¡æ•°ç”¨å®Œï¼Œåšä»»åŠ¡èµšå–æ›´å¤š";
            } else {
                btn.innerText = "æ±‚å–é©¬å¹´ç¾è‚¡çµç­¾";
                btn.onclick = checkAndDraw;
                btn.style.background = ""; 
                btn.style.color = "";
                hint.innerHTML = `ä»Šæ—¥å‰©ä½™æœºä¼šï¼š<span style="color:#fff; font-size:16px;">${remaining}</span>`;
            }

            const data = getPlayData();
            const checkinBtn = document.getElementById('btn-checkin');
            const readBtn = document.getElementById('btn-read');
            if (data.tasks.checkin) { checkinBtn.innerText = "å·²ç­¾åˆ°"; checkinBtn.classList.add('done'); }
            if (data.tasks.read) { readBtn.innerText = "å·²é˜…è¯»"; readBtn.classList.add('done'); }
        }

        // --- 3. æŠ½ç­¾ ---

        function pickRandomFortune() {
            const index = Math.floor(Math.random() * fortuneConfig.length);
            return fortuneConfig[index];
        }

        function pickRandomCoupon() {
            const rand = Math.random();
            let accumulatedProb = 0;
            for (let c of couponConfig) {
                accumulatedProb += c.prob;
                if (rand <= accumulatedProb) {
                    return { finalPrice: c.finalPrice, discountAmount: ORIGINAL_PRICE - c.finalPrice };
                }
            }
            return { finalPrice: 688, discountAmount: ORIGINAL_PRICE - 688 };
        }

        function checkAndDraw() {
            const remaining = getRemainingChances();
            if (remaining <= 0) { goToTasks(); return; }

            const data = getPlayData();
            data.used_count += 1;
            savePlayData(data);

            const fortune = pickRandomFortune();
            const coupon = pickRandomCoupon();
            
            currentDrawResult = {
                id: Date.now(),
                fortuneTitle: fortune.title,
                fortuneBadge: fortune.badge,
                fortuneText: fortune.text,
                finalPrice: coupon.finalPrice,
                discount: coupon.discountAmount,
                date: new Date().toLocaleString()
            };

            document.getElementById('res-fortune-badge').innerText = fortune.badge;
            document.getElementById('res-fortune-title').innerText = fortune.title;
            document.getElementById('res-fortune-text').innerText = fortune.text;
            document.getElementById('res-gift-title').innerText = `æ­å–œï¼å‘ç°ä¸€ä¸ªâ€œä»·å€¼${coupon.discountAmount}å…ƒçš„é©¬å¹´ä¸“å±ä¼˜æƒ åˆ¸â€`;

            updateOfferPage(currentDrawResult);

            const btn = document.querySelector('#page-landing .btn');
            const landingPage = document.getElementById('page-landing');
            const resultPage = document.getElementById('page-result');

            btn.innerHTML = "æ­£åœ¨è§£æåå°”è¡—æ•°æ®...";
            btn.style.opacity = "0.8";

            setTimeout(() => {
                saveCouponHistory(currentDrawResult);
                
                landingPage.classList.add('fade-out');
                setTimeout(() => {
                    landingPage.classList.add('hidden');
                    resultPage.classList.add('fade-in');
                    btn.innerHTML = "æ±‚å–é©¬å¹´ç¾è‚¡çµç­¾";
                    btn.style.opacity = "1";
                }, 500);
            }, 1000);
        }

        function updateOfferPage(data) {
            document.getElementById('offer-price-num').innerText = data.finalPrice;
            document.getElementById('offer-tag').innerText = `å·²ä¼˜æƒ ${data.discount}å…ƒ`;
            const saved = ORIGINAL_PRICE - data.finalPrice;
            document.getElementById('offer-daily-price').innerText = `å·²æ¯”å®˜ç½‘æ¸ é“ä»·è¿˜ä¼˜æƒ ${saved}å…ƒ`;
        }

        // --- 4. ä»»åŠ¡ä¸è·³è½¬ ---

        function doTask(type) {
            const data = getPlayData();
            currentTaskType = type;
            if (type === 'checkin') {
                if (data.tasks.checkin) return;
                data.tasks.checkin = true; data.earned_count += 1;
                savePlayData(data); alert('ç­¾åˆ°æˆåŠŸï¼è·å¾— +1 æ¬¡æœºä¼š');
            } else if (type === 'read_article') {
                if (data.tasks.read) return;
                alert('æ­£åœ¨è·³è½¬æ–‡ç« ...'); 
                setTimeout(() => { data.tasks.read = true; data.earned_count += 1; savePlayData(data); alert('é˜…è¯»å®Œæˆï¼è·å¾— +1 æ¬¡æœºä¼š'); }, 1000);
            } else {
                document.getElementById('shareModal').style.display = 'flex';
            }
        }

        function simulateShareSuccess() {
            const data = getPlayData();
            let reward = (currentTaskType === 'share_moments') ? 2 : 1;
            data.earned_count += reward;
            savePlayData(data);
            closeModal(document.getElementById('shareModal'));
            alert(`åˆ†äº«æˆåŠŸï¼è·å¾— +${reward} æ¬¡æœºä¼š`);
        }

        function saveCouponHistory(item) {
            let list = JSON.parse(localStorage.getItem('barrons_coupons_v5') || "[]");
            list.unshift(item);
            localStorage.setItem('barrons_coupons_v5', JSON.stringify(list));
        }

        function goToOffer() {
            hideAllPages();
            const page = document.getElementById('page-offer');
            if(currentDrawResult) updateOfferPage(currentDrawResult);
            page.classList.remove('hidden'); page.classList.add('fade-in');
            startTimer();
        }

        function showCouponModal() {
            const modal = document.getElementById('couponModal');
            const container = document.getElementById('couponList');
            const list = JSON.parse(localStorage.getItem('barrons_coupons_v5') || "[]");
            modal.style.display = 'flex';
            if (list.length === 0) {
                container.innerHTML = '<p style="margin-top:20px; color:#999; font-size:12px;">æš‚æ— å¡åˆ¸ï¼Œå¿«å»æ±‚ç­¾å§ï¼</p>';
            } else {
                let html = '';
                list.slice(0, 50).forEach(c => {
                    html += `
                        <div class="coupon-item">
                            <div class="c-left" style="text-align:left;">
                                <h4>Â¥${c.finalPrice} ä¸“äº«ä»·</h4>
                                <p>${c.fortuneTitle}</p>
                                <p style="font-size:10px; color:#999;">${c.date}</p>
                            </div>
                            <button class="c-btn" onclick="useHistoryCoupon(${c.finalPrice}, ${c.discount})">å»ä½¿ç”¨</button>
                        </div>`;
                });
                container.innerHTML = html;
            }
        }

        function useHistoryCoupon(price, discount) {
            updateOfferPage({ finalPrice: price, discount: discount });
            closeModal(document.getElementById('couponModal'));
            goToOffer();
        }

        function goToTasks() { hideAllPages(); const p = document.getElementById('page-tasks'); p.classList.remove('hidden'); p.classList.add('fade-in'); }
        function backToHome() { hideAllPages(); const p = document.getElementById('page-landing'); p.classList.remove('hidden'); p.classList.add('fade-in'); }
        function hideAllPages() { ['page-landing', 'page-result', 'page-offer', 'page-tasks'].forEach(id => { const el = document.getElementById(id); el.classList.add('hidden'); el.classList.remove('fade-in'); }); }
        function closeModal(m) { m.style.display = 'none'; }
        function startTimer() {
            let totalSeconds = 4 * 3600 + 59 * 60 + 59; 
            const timerElement = document.getElementById('timer');
            if(window.offerTimer) clearInterval(window.offerTimer);
            window.offerTimer = setInterval(() => {
                if (totalSeconds <= 0) { clearInterval(window.offerTimer); timerElement.innerText = "00:00:00"; return; }
                totalSeconds--;
                const h = Math.floor(totalSeconds / 3600);
                const m = Math.floor((totalSeconds % 3600) / 60);
                const s = totalSeconds % 60;
                timerElement.innerText = `${h < 10 ? '0'+h : h}:${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
            }, 1000);
        }
    </script>
</body>
</html>